var t,e;t=new/*#__PURE__*/(function(){var t;function e(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),console.log(t),this.score=0,this.status="idle",this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}return t=[{key:"moveLeft",value:function(){if("playing"===this.status){for(var t=this.state,e=structuredClone(this.state),s=0;s<t.length;s++){var n=t[s].length;t[s]=i(t[s]);for(var a=0;a<t[s].length;a++)t[s][a]===t[s][a+1]&&(t[s][a]*=2,t[s][a+1]=0,this.score+=+t[s][a],t[s]=i(t[s]));for(var r=t[s].length;r<n;r++)t[s].push(0)}this.checkChangesState(e),this.updateUI()}function i(t){return t.filter(function(t){return 0!==t})}}},{key:"moveRight",value:function(){if("playing"===this.status){for(var t=this.state,e=structuredClone(this.state),s=0;s<t.length;s++){var n=t[s].length;t[s]=o(t[s]);for(var a=!1,r=t[s].length;r>0;r--){if(a){a=!1;continue}t[s][r]===t[s][r-1]&&(t[s][r]*=2,t[s][r-1]=0,this.score+=+t[s][r],t[s]=o(t[s]),a=!0)}for(var i=t[s].length;i<n;i++)t[s].unshift(0)}this.checkChangesState(e),this.updateUI()}function o(t){return t.filter(function(t){return 0!==t})}}},{key:"moveUp",value:function(){if("playing"===this.status){var t=this.state,e=structuredClone(this.state);this.transpose(t);for(var s=0;s<t.length;s++){var n=t[s].length;t[s]=i(t[s]);for(var a=0;a<t[s].length;a++)t[s][a]===t[s][a+1]&&(t[s][a]*=2,t[s][a+1]=0,this.score+=+t[s][a],t[s]=i(t[s]));for(var r=t[s].length;r<n;r++)t[s].push(0)}this.transpose(t),this.checkChangesState(e),this.updateUI()}function i(t){return t.filter(function(t){return 0!==t})}}},{key:"moveDown",value:function(){if("playing"===this.status){var t=this.state,e=structuredClone(this.state);this.transpose(t);for(var s=0;s<t.length;s++){var n=t[s].length;t[s]=o(t[s]);for(var a=!1,r=t[s].length;r>0;r--){if(a){a=!1;continue}t[s][r]===t[s][r-1]&&(t[s][r]*=2,t[s][r-1]=0,this.score+=+t[s][r],t[s]=o(t[s]),a=!0)}for(var i=t[s].length;i<n;i++)t[s].unshift(0)}this.transpose(t),this.checkChangesState(e),this.updateUI()}function o(t){return t.filter(function(t){return 0!==t})}}},{key:"getScore",value:function(){document.querySelector(".game-score").textContent=this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){"idle"===this.status?(document.querySelector(".message-start").classList.add("hidden"),this.status="playing"):"playing"===this.status?(document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-start").classList.remove("hidden"),this.status="idle"):"lose"===this.status?(document.querySelector(".message-lose").classList.remove("hidden"),this.status="playing"):"win"===this.status&&document.querySelector(".message-win").classList.remove("hidden")}},{key:"start",value:function(){this.addRandomTile(),this.getStatus(),this.updateUI()}},{key:"restart",value:function(){this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,"win"===this.status&&(this.status="playing"),this.getStatus(),this.getScore(),this.updateUI()}},{key:"addRandomTile",value:function(){var t=this.status;function e(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=Math.floor(4*Math.random());return e&&"playing"===t?(s=Math.random())<.9?2:4:e&&"idle"===t?0===(s=Math.floor(2*Math.random()))?2:4:s}function s(t){for(var s=!0;s;){var n=e(),a=e();t[n][a]||(t[n][a]=e(!0),s=!1)}}0===this.state.flat().filter(function(t){return 0!==t}).length&&s(this.state),s(this.state)}},{key:"checkChangesState",value:function(t){var e=t.flat().join(""),s=this.state.flat().join(""),n=this.state.flat().filter(function(t){return 0!==t}).length;if(e!==s)this.addRandomTile(!0);else if(16===n){for(var a=this.state,r=!1,i=0;i<a.length;i++)for(var o=0;o<a.length;o++){var u=a[i][o];if(0===u){r=!0;break}(o+1<a.length&&u===a[i][o+1]||i+1<a.length&&u===a[i+1][o])&&(r=!0)}r||(this.status="lose",this.getStatus())}}},{key:"updateUI",value:function(){var t=document.querySelectorAll(".field-cell");this.state.flat().some(function(t){return 2048===t})&&(this.status="win",this.getStatus());for(var e=0;e<t.length;e++)this.state.flat()[e]?(t[e].textContent=this.state.flat()[e],t[e].classList="field-cell field-cell--".concat(t[e].textContent)):(t[e].textContent="",t[e].classList="field-cell");this.getScore()}},{key:"transpose",value:function(t){for(var e=t.length,s=t[0].length,n=0;n<e;n++)for(var a=n+1;a<s;a++){var r=t[n][a];t[n][a]=t[a][n],t[a][n]=r}}}],function(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}()),(e=document.querySelector(".button")).addEventListener("click",function(){e.matches(".start")?(t.start(),e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"):(t.restart(),e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start")}),document.addEventListener("keydown",function(e){"ArrowLeft"===e.key&&t.moveLeft(),"ArrowRight"===e.key&&t.moveRight(),"ArrowUp"===e.key&&t.moveUp(),"ArrowDown"===e.key&&t.moveDown()});
//# sourceMappingURL=index.4e153867.js.map
